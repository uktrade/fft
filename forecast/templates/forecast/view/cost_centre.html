{% extends "wide_content.html" %}
{% load render_table from django_tables2 %}
{% load django_bootstrap_breadcrumbs %}

{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb "DIT" "forecast_dit" %}
    {% breadcrumb view.cost_centre.directorate.group.group_name "forecast_group" view.cost_centre.directorate.group_id %}
    {% breadcrumb view.cost_centre.directorate.directorate_name "forecast_directorate" view.cost_centre.directorate.directorate_code %}
    {% breadcrumb view.cost_centre.cost_centre_name "forecast_cost_centre" view.cost_centre.cost_centre_code %}
{% endblock %}

{% block content %}
    <h1 class="govuk-heading-l">{{ view.cost_centre.cost_centre_name }} - {{ view.cost_centre.cost_centre_code }}</h1>
    <div class="action-bar-wrapper">
        <div class="action-bar">
            <a class="govuk-button govuk-button" href="{% url 'export_forecast_data_cost_centre' view.cost_centre.cost_centre_code %} ">Download raw data</a>
            <form method="post" action="" class="cost-centre-choice-form">
                {% csrf_token %}
                {% for field in view.cost_centres_form  %}
                    <label class="govuk-label" for="{{ field.name }}">
                        {{ field.label }}{% if field.field.required == False %} (optional){% endif %}
                    </label>
                    {% if field.errors %}
                        {% for error in field.errors %}
                            <span id="{{ field.name }}-issued-error" class="govuk-error-message">
                                <span class="govuk-visually-hidden">Error:</span>
                                {{ error|escape }}
                            </span>
                        {% endfor %}
                    {% endif %}
                    {{ field }}
                {% endfor %}
                <input type="submit" value="Change" class="govuk-button govuk-button--secondary" data-module="govuk-button"/>
            </form>
        </div>
    </div>
    {% for table in tables %}
        <div class="tables-container cc-forecast-table">
            {% render_table table %}
        </div>
    {% endfor %}
{% endblock %}

{% block scripts %}
<script type="application/javascript">
    let allCC = document.getElementById("all-cc");
    let myCC = document.getElementById("my-cc");

    if (allCC && myCC) {
        myCC.style.display = "none";
        document.getElementById("id_mode_0").checked = true;

        function swapCostCentreChoice(input) {
            if (input.id === "id_mode_0") {
                allCC.style.display = "block";
                myCC.style.display = "none";
            } else {
                allCC.style.display = "none";
                myCC.style.display = "block";
            }
        }
    }
</script>
{% endblock %}