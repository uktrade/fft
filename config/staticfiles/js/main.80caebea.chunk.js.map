{"version":3,"sources":["../../node_modules/webpack/hot sync nonrecursive /^/.//log$","Reducers/Mouse.js","Reducers/Cells.js","Reducers/Edit.js","Reducers/Select.js","Store.js","Components/RowContext/index.js","Components/TableRow/index.js","Util.js","Components/TableCell/index.js","Components/TableHandle/index.js","Components/ColumnHeader/index.js","Components/Table/index.js","App.js","serviceWorker.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","SET_MOUSE_DOWN","mouseInitial","down","allCells","createSlice","slice","initialState","reducers","ADD_CELL","state","action","payload","index","programmeCode","naturalAccountCode","projectCode","key","editable","value","rowIndex","rect","selected","edited","SET_RECT","SELECT_CELL","UNSELECT_CELL","SET_EDITED","SET_VALUE","UNSELECT_ALL","cellId","actions","SET_EDIT_CELL","editCellInitial","select","initial","last","SET_INITIAL_CELL","SET_LAST_CELL","persistConfig","storage","appReducer","combineReducers","mouse","type","assign","editCell","store","persistReducer","createStore","RowContext","React","createContext","RowProvider","Provider","Consumer","TableRow","children","dispatch","useDispatch","useSelector","selectRow","setInital","cell","selectColumn","colKey","className","getCellId","months","TableCell","cellRef","createRef","inputRef","useRef","mouseDn","useEffect","current","getBoundingClientRect","focus","cellData","isSelected","ref","onDoubleClick","onMouseOver","onMouseDown","onChange","target","parseInt","onKeyPress","event","onKeyDown","keyCode","colIndex","indexOf","inScope","push","nextCell","filter","TableHandle","context","useContext","onClick","ColumnHeader","Table","initialCell","lastCell","useState","errorMessage","setErrorMessage","mouseDown","captureMouseDn","srcElement","localName","captureMouseUp","handleKeyDown","console","log","getState","getTopLeftCell","cells","topLeftCell","x","y","capturePaste","lines","clipboardData","getData","split","selectedCells","lineParts","linePart","setClipBoardContent","preventDefault","clipBoardContent","navigator","clipboard","writeText","window","cell_data","cellIndex","table_data","forEach","i","editable_periods","length","shortName","toLowerCase","addEventListener","removeEventListener","horizontalDirection","verticalDirection","selectable","aria-labelledby","role","tabIndex","data-module","href","monthCells","month","getCells","App","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.80caebea.chunk.js","sourcesContent":["var map = {\n\t\"./log\": 39\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 38;","\nexport const SET_MOUSE_DOWN = 'SET_MOUSE_DOWN';\n\nconst mouseInitial = {\n    down: false\n};\n\nexport const mouse = (state = mouseInitial, action) => {\n    switch (action.type) {\n        case SET_MOUSE_DOWN:\n            return Object.assign({}, state, {\n                down: action.down\n            });\n        default:\n            return state;\n    }\n}\n","import { createSlice, PayloadAction } from 'redux-starter-kit';\n// Use of this lib guarentees no state mutatation\n\nconst allCells = createSlice({\n    slice: 'allCells',\n    initialState: {},\n    reducers: {\n        ADD_CELL: (state, action) => {\n            state[action.payload.id] = {\n                index: action.payload.index,\n                programmeCode: action.payload.programmeCode,\n                naturalAccountCode: action.payload.naturalAccountCode,\n                projectCode: action.payload.projectCode,\n                id: action.payload.id,\n                key: action.payload.key,\n                editable: action.payload.editable,\n                value: action.payload.value,\n                rowIndex: action.payload.rowIndex,\n                rect: null,\n                selected: false,\n                edited: false\n            }\n        },\n        SET_RECT: (state, action) => {\n            state[action.payload.id][\"rect\"] = action.payload.rect;\n        },\n        SELECT_CELL: (state, action) => {\n            state[action.payload.id][\"selected\"] = true;\n        },\n        UNSELECT_CELL: (state, action) => {\n            state[action.payload.id][\"selected\"] = false;\n        },\n        SET_EDITED: (state, action) => {\n            state[action.payload.id][\"edited\"] = true;\n        },\n        SET_VALUE: (state, action) => {\n            state[action.payload.id][\"value\"] = action.payload.value;\n        },\n        UNSELECT_ALL: (state, action) => {\n            for (var cellId in state) {\n                state[cellId][\"selected\"] = false;\n            }\n        }\n    }\n});\n\nexport const { \n    ADD_CELL, \n    SELECT_CELL,\n    UNSELECT_CELL,\n    SET_EDITED,\n    UNSELECT_ALL,\n    SET_RECT,\n    SET_VALUE\n} = allCells.actions;\n\nexport default allCells.reducer;\n","\nexport const SET_EDIT_CELL = 'SET_EDIT_CELL';\n\nconst editCellInitial = {\n\tcellId: null\n}\n\nexport const editCell = (state = editCellInitial, action) => {\n    switch (action.type) {\n        case SET_EDIT_CELL:\n            return Object.assign({}, state, {\n            \tcellId: action.cellId\n            });\n        default:\n            return state;\n    }\n}\n","import { createSlice, PayloadAction } from 'redux-starter-kit';\n// Use of this lib guarentees no state mutatation\n\nconst select = createSlice({\n    slice: 'select',\n    initialState: {\n        initial: null,\n        last: null\n    },\n    reducers: {\n        SET_INITIAL_CELL: (state, action) => {\n            state[\"initial\"] = action.payload.id\n        },\n        SET_LAST_CELL: (state, action) => {\n            state[\"last\"] = action.payload.id\n        }\n    }\n});\n\nexport const {\n    SET_INITIAL_CELL,\n    SET_LAST_CELL,\n} = select.actions;\n\nexport default select.reducer;\n","'use strict';\n\nimport { createStore, combineReducers } from 'redux';\nimport { persistStore, persistReducer } from 'redux-persist';\nimport storage from 'redux-persist/lib/storage';\nimport { mouse } from './Reducers/Mouse';\nimport allCells from './Reducers/Cells';\nimport { editCell } from './Reducers/Edit'\nimport select from './Reducers/Select'\n\nconst persistConfig = {\n    key: 'root',\n    //transforms: [encryptor],\n    storage\n}\n\nconst appReducer = combineReducers({\n    mouse,\n    allCells,\n    editCell,\n    select,\n});\n\nconst persistedReducer = persistReducer(persistConfig, appReducer)\n\n//export const store = createStore(persistedReducer);\nexport const store = createStore(appReducer);\n//export const persistor = persistStore(store);\nexport const purge = () => {\n    //persistor.purge();\n    localStorage.clear();\n};\n","import React from 'react'\n\nconst RowContext = React.createContext({})\n\nexport const RowProvider = RowContext.Provider\nexport const RowConsumer = RowContext.Consumer\nexport default RowContext\n","import React, {Fragment, useState, useEffect, useRef } from 'react';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\nimport { RowProvider } from  '../../Components/RowContext'\nimport { \n    SELECT_CELL,\n    UNSELECT_CELL,\n    UNSELECT_ALL\n} from '../../Reducers/Cells'\nimport {\n    SET_INITIAL_CELL,\n    SET_LAST_CELL\n} from '../../Reducers/Select'\n\nfunction TableRow({children, index}) {\n    const dispatch = useDispatch();\n    const allCells = useSelector(state => state.allCells);\n\n    const selectRow = (rowIndex) => {\n\n        dispatch(\n            UNSELECT_ALL()\n        );\n\n        let setInital = false;\n\n        for (let cellId in allCells) {\n            let cell = allCells[cellId];\n            if (cell.editable && cell.rowIndex == rowIndex) {\n                if (!setInital) {\n                    dispatch(\n                        SET_INITIAL_CELL({\n                            id: cellId\n                        })\n                    );\n                    setInital = true;\n                }\n\n                dispatch(\n                    SELECT_CELL({\n                        id: cellId\n                    })\n                );\n\n                // TODO - set this as actual last cell in row (needs to use array rather than object state)\n\n                dispatch(\n                    SET_LAST_CELL({\n                        id: cellId\n                    })\n                );\n\n            }\n       }\n    }\n\n    const selectColumn = (colKey) => {\n        dispatch(\n            UNSELECT_ALL()\n        );\n        let setInital = false;\n\n        for (let cellId in allCells) {\n            let cell = allCells[cellId];\n            if (cell.key == colKey) {\n                if (!setInital) {\n                    dispatch(\n                        SET_INITIAL_CELL({\n                            id: cellId\n                        })\n                    );\n                    setInital = true;\n                }\n\n                dispatch(\n                    SELECT_CELL({\n                        id: cell.id\n                    })\n                );\n\n                dispatch(\n                    SET_LAST_CELL({\n                        id: cellId\n                    })\n                );\n            }\n       }\n    }\n\n    return (\n        <RowProvider value={{ \n            selectRow: selectRow,\n            selectColumn: selectColumn\n        }}>\n            <tr className=\"govuk-table__row\">\n                {children}\n            </tr>\n        </RowProvider>\n    );\n}\n\nexport default TableRow;\n","\nexport const getCellId = (key, index) => {\n    return \"id_\" + key + \"_\" + index;\n}\n\nexport const months = [ \n    \"apr\", \n    \"may\", \n    \"jun\",\n    \"jul\", \n    \"aug\", \n    \"sep\", \n    \"oct\", \n    \"nov\", \n    \"dec\",\n    \"jan\", \n    \"feb\", \n    \"mar\"\n];\n","import React, {Fragment, useState, useEffect, useRef, useContext } from 'react';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\nimport {\n    SET_RECT,\n    SELECT_CELL,\n    SET_VALUE,\n    UNSELECT_ALL\n} from '../../Reducers/Cells'\nimport { \n    SET_EDIT_CELL\n} from '../../Reducers/Edit'\nimport {\n    SET_INITIAL_CELL,\n    SET_LAST_CELL\n} from '../../Reducers/Select'\nimport {\n    getCellId,\n    months\n} from '../../Util'\n\nfunction TableCell({children, index, cellId}) {\n    const dispatch = useDispatch();\n\n    let cellRef = React.createRef();\n    const inputRef = useRef(null);\n\n    const mouseDn = useSelector(state => state.mouse.down);\n    const allCells = useSelector(state => state.allCells);\n    const editCell = useSelector(state => state.editCell.cellId);\n\n    const selectCell = () => {\n        if (mouseDn) {\n            dispatch(\n                SELECT_CELL({\n                    id: cellId\n                })\n            );\n\n            dispatch(\n                SET_LAST_CELL({\n                    id: cellId\n                })\n            );\n        }\n    }\n\n    useEffect(() => {\n        if (allCells) {\n            dispatch(\n                SET_RECT({\n                    id: cellId,\n                    rect: cellRef.current.getBoundingClientRect()\n                })\n            );\n        }\n    }, []);\n\n    useEffect(() => {\n        if (inputRef && inputRef.current) {\n            inputRef.current.focus();\n        }\n    });\n\n    const isSelected = () => {\n        let cellData = allCells[cellId];\n\n        if (cellData && cellData.selected) {\n            return true;\n        }\n\n        return false\n    }\n\n    const handleKeyPress = (event) => {\n        if(event.key === 'Enter'){\n            dispatch({\n                type: SET_EDIT_CELL,\n                cellId: null\n            });\n        }\n    }\n\n    const handleKeyDown = (event) => {\n        if (event.keyCode == 9) {\n            // Get next cell\n            let cellData = allCells[cellId]\n            let colIndex = months.indexOf(cellData.key);\n\n            let inScope = [];\n\n            // TODO - do this once at the start of the app\n            for (const key in allCells) {\n                let cell = allCells[key];\n                inScope.push(cell);\n            }\n\n            let cells = inScope.filter((cell) => {\n                return (\n                    cell.rowIndex == cellData.rowIndex &&\n                    cell.key === months[colIndex + 1]\n                )\n            })\n\n            let nextCell = cells[0]\n\n            dispatch({\n                type: UNSELECT_ALL\n            });\n\n            dispatch(\n                SET_LAST_CELL({\n                    id: nextCell.id\n                })\n            );\n\n            dispatch(\n                SET_INITIAL_CELL({\n                    id: nextCell.id\n                })\n            );\n\n            dispatch(\n                SELECT_CELL({\n                    id: nextCell.id\n                })\n            );\n\n            dispatch({\n                type: SET_EDIT_CELL,\n                cellId: nextCell.id\n            });\n        }\n    }\n\n    const setContentState = (value) => {\n        //setCellContent(value);\n        if (!parseInt(value)) {\n            return\n        }\n\n        dispatch(\n            SET_VALUE({\n                id: cellId,\n                value: value\n            })\n        );\n    }\n\n    return (\n        <Fragment>\n            <td\n                className={isSelected() ? 'highlight govuk-table__cell' : 'no-select govuk-table__cell'}\n                ref={cellRef}\n                onDoubleClick={ () => {\n                    dispatch({\n                        type: SET_EDIT_CELL,\n                        cellId: cellId\n                    });\n                }}\n\n                onMouseOver={ () => { \n                    selectCell();\n                }}\n\n                onMouseDown={ () => {\n                    dispatch(\n                        SELECT_CELL({\n                            id: cellId\n                        })\n                    );\n\n                    dispatch(\n                        SET_INITIAL_CELL({\n                            id: cellId\n                        })\n                    );\n\n                    dispatch(\n                        SET_LAST_CELL({\n                            id: cellId\n                        })\n                    );\n                }}\n            >\n                {editCell == cellId ? (\n                    <input\n                        className=\"cell-input\"\n                        ref={inputRef}\n                        type=\"text\"\n                        value={allCells[cellId].value}\n                        onChange={e => setContentState(e.target.value)}\n                        onKeyPress={handleKeyPress}\n                        onKeyDown={handleKeyDown}\n                    />\n                ) : (\n                    <Fragment>\n                        {allCells[cellId].value}\n                    </Fragment>\n                )}\n            </td>\n        </Fragment>\n    );\n}\n\nexport default TableCell;\n","import React, {Fragment, useState, useEffect, useRef, useContext } from 'react';\n\nimport RowContext from '../../Components/RowContext'\n\nfunction TableHandle({children, rowIndex}) {\n\tconst context = useContext(RowContext)\n\n\treturn (\n\t\t<td className=\"handle govuk-table__cell indicate-action\"\n\t\t\tonClick={() => { \n\t\t\t\tcontext.selectRow(rowIndex);\n\t\t\t}\n\t\t}>\n\t\t\t{children}\n\t\t</td>\n\t);\n}\n\nexport default TableHandle;\n","import React, {Fragment, useState, useEffect, useRef, useContext } from 'react';\n\nimport RowContext from '../../Components/RowContext'\n\nfunction ColumnHeader({children, colKey}) {\n    const context = useContext(RowContext)\n\n    return (\n        <th className=\"govuk-table__header indicate-action\"\n            onClick={() => {\n                context.selectColumn(colKey);\n            }\n        }>\n            {children}\n        </th>\n    );\n}\n\nexport default ColumnHeader;\n","import React, {Fragment, useState, useEffect, useRef } from 'react';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\n\nimport { store } from '../../Store';\n\nimport TableRow from '../../Components/TableRow/index'\nimport TableCell from '../../Components/TableCell/index'\nimport TableHandle from '../../Components/TableHandle/index'\nimport ColumnHeader from '../../Components/ColumnHeader/index'\nimport { SET_MOUSE_DOWN } from '../../Reducers/Mouse'\nimport { \n    SET_EDIT_CELL\n} from '../../Reducers/Edit'\nimport {\n    ADD_CELL,\n    SELECT_CELL,\n    UNSELECT_CELL,\n    UNSELECT_ALL,\n    SET_VALUE,\n} from '../../Reducers/Cells'\nimport {\n    getCellId,\n    months\n} from '../../Util'\nimport {\n    SET_INITIAL_CELL,\n    SET_LAST_CELL\n} from '../../Reducers/Select'\n\nfunction Table() {\n    const LEFT_TO_RIGHT = 'LEFT_TO_RIGHT';\n    const RIGHT_TO_LEFT = 'RIGHT_TO_LEFT';\n\n    const TOP_TO_BOTTOM = 'TOP_TO_BOTTOM';\n    const BOTTOM_TO_TOP = 'BOTTOM_TO_TOP';\n\n    const dispatch = useDispatch();\n    const initialCell = useSelector(state => state.select.initial);\n    const lastCell = useSelector(state => state.select.last);\n\n    const [allCellsArr, setAllCellsArr] = useState([]);\n    const [errorMessage, setErrorMessage] = useState(null);\n\n    // const selectedCells = useSelector(state => state.selection.cells);\n    //const allCells = useSelector(state => state.allCells);\n    // const isSelecting = useSelector(state => state.selection.isSelecting);\n\n    const mouseDown = useSelector(state => state.mouse.down);\n    const allCells = useSelector(state => state.allCells);\n\n    //const [tableData, setTableData] = useState([]);\n\n    const captureMouseDn = (e) => {\n        dispatch({\n            type: UNSELECT_ALL\n        });\n        \n        if (e.srcElement.localName != \"input\") {\n            dispatch({\n                type: SET_EDIT_CELL,\n                cellId: null\n            });\n        }\n\n        dispatch({\n            type: SET_MOUSE_DOWN,\n            down: true\n        });\n    }\n\n    const captureMouseUp = (e) => {\n        dispatch({\n            type: SET_MOUSE_DOWN,\n            down: false\n        });\n    }\n\n    const handleKeyDown = (event) => {\n        console.log(event);\n        if (event.keyCode == 9 && event.target.localName != \"input\") {            \n            const state = store.getState();\n            // Get next cell\n            let cellData =  state.allCells[state.select.initial]\n            let colIndex = months.indexOf(cellData.key);\n\n            let inScope = [];\n\n            // TODO - do this once at the start of the app\n            for (const key in state.allCells) {\n                let cell = state.allCells[key];\n                inScope.push(cell);\n            }\n\n            console.log(inScope);\n\n            let cells = inScope.filter((cell) => {\n                return (\n                    cell.rowIndex == cellData.rowIndex &&\n                    cell.key === months[colIndex + 1]\n                )\n            })\n\n            let nextCell = cells[0]\n\n            dispatch({\n                type: UNSELECT_ALL\n            });\n\n            dispatch(\n                SET_LAST_CELL({\n                    id: nextCell.id\n                })\n            );\n\n            dispatch(\n                SET_INITIAL_CELL({\n                    id: nextCell.id\n                })\n            );\n\n            dispatch(\n                SELECT_CELL({\n                    id: nextCell.id\n                })\n            );\n\n            dispatch({\n                type: SET_EDIT_CELL,\n                cellId: nextCell.id\n            });\n        }\n    }\n\n    const getTopLeftCell = (cells, initialCell) => {\n        let topLeftCell = initialCell;\n\n        for (const cell of cells) {\n            if (cell.rect.x < topLeftCell.rect.x && \n                cell.rect.y < topLeftCell.rect.y) {\n                topLeftCell = cell\n            }\n        }\n\n        return topLeftCell\n    }\n\n    const capturePaste = (e) => {\n        let pasteContent = e.clipboardData.getData('Text');\n        let lines = pasteContent.split('\\n');\n        const state = store.getState();\n\n        let initial = state.select.initial;\n        let initialCell = state.allCells[initial];\n\n        let inScope = [];\n        // TODO - do this once at the start of the app\n        for (const key in state.allCells) {\n            let cell = state.allCells[key];\n            inScope.push(cell);\n        }\n\n        if (!initialCell.selected) {\n            return\n        }\n\n        let selectedCells = inScope.filter((cell) => {\n            return cell.selected\n        });\n\n        // Find top left cell\n        let topLeftCell = getTopLeftCell(selectedCells, initialCell)\n        let rowIndex = topLeftCell.rowIndex\n\n        for (const line of lines) {\n            let lineParts = line.split('\\t')\n            let colIndex = months.indexOf(topLeftCell.key);\n\n            for (const linePart of lineParts) {\n                if (!parseInt(linePart)) {\n                    setErrorMessage(\"You can only paste whole numbers into cells\");\n                    continue\n                }\n\n                let cells = inScope.filter((cell) => {\n                    return (\n                        cell.rowIndex == rowIndex &&\n                        cell.key === months[colIndex]\n                    )\n                })\n                if (cells[0]) {\n                    dispatch(\n                        SET_VALUE({\n                            id: cells[0].id,\n                            value: linePart\n                        })\n                    );\n\n                    dispatch(\n                        SELECT_CELL({\n                            id: cells[0].id\n                        })\n                    );\n\n                    dispatch(\n                        SET_LAST_CELL({\n                            id: cells[0].id\n                        })\n                    )\n                }\n\n                colIndex++\n            }\n            rowIndex++\n        }\n    }\n\n    const setClipBoardContent = (e) => {\n\n        const state = store.getState();\n        // TODO - do this once at the start of the app\n        let inScope = [];\n        for (const key in state.allCells) {\n            let cell = state.allCells[key];\n            inScope.push(cell);\n        }\n\n        let initial = state.select.initial;\n        let initialCell = state.allCells[initial];\n\n        if (!initialCell.selected) {\n            return\n        }\n\n        e.preventDefault();\n\n        let selectedCells = inScope.filter((cell) => {\n            return cell.selected\n        });\n\n        let topLeftCell = getTopLeftCell(selectedCells, initialCell)\n\n        console.log(selectedCells);\n\n        let clipBoardContent = \"\";\n\n        // let currentRow = topLeftCell.rowIndex\n\n        let rowIndex = topLeftCell.rowIndex\n\n        for (const cell of selectedCells) {\n            if (cell.rowIndex != rowIndex) {\n                rowIndex = cell.rowIndex\n                clipBoardContent += \"\\n\"\n            }\n            clipBoardContent += cell.value + \"\\t\"\n\n            console.log(cell.value + \"\\t\");\n            console.log(clipBoardContent);\n        }\n\n        console.log(\"clipBoardContent.trim()\", clipBoardContent);\n\n        navigator.clipboard.writeText(clipBoardContent)\n    }\n\n    useEffect(() => {\n        window.cell_data = allCells;\n    }, [allCells]);\n\n    useEffect(() => {\n        let cellIndex = 0;\n        window.table_data.forEach(function (cellData, rowIndex) {\n            for (let key in cellData) {\n\n                let editable = false;\n\n                for (let i = 0; i < window.editable_periods.length; i++) {\n                    let shortName = window.editable_periods[i][\"fields\"][\"period_short_name\"];\n                    if (shortName && shortName.toLowerCase() == key) {\n                        editable = true;\n                        break;\n                    }\n                }\n\n                dispatch(\n                    ADD_CELL({\n                        id: getCellId(key, rowIndex),\n                        index: cellIndex,\n                        rowIndex: rowIndex,\n                        key: key,\n                        value: cellData[key],\n                        editable: editable,\n                        programmeCode: cellData[\"programme__programme_code\"],\n                        naturalAccountCode: cellData[\"natural_account_code__natural_account_code\"]\n                    })\n                );\n                cellIndex++;\n            }\n        });\n\n        window.addEventListener(\"mousedown\", captureMouseDn);\n        window.addEventListener(\"mouseup\", captureMouseUp);\n        window.addEventListener(\"paste\", capturePaste);\n        window.addEventListener(\"keydown\", handleKeyDown);\n        window.addEventListener(\"copy\", setClipBoardContent);\n\n        return () => {\n            window.removeEventListener(\"onmouseup\", captureMouseDn);\n            window.removeEventListener(\"mousedown\", captureMouseUp);\n            window.removeEventListener(\"paste\", capturePaste);\n            window.removeEventListener(\"keydown\", handleKeyDown);\n            window.removeEventListener(\"copy\", setClipBoardContent);\n        };\n    }, []);\n\n\tif (mouseDown) {\n\t\tlet initial = allCells[initialCell];\n\t\tlet last = allCells[lastCell];\n\n\t\tif (initial && last) {\n\n            let horizontalDirection = LEFT_TO_RIGHT;\n            let verticalDirection = TOP_TO_BOTTOM;\n\n            // Check for select direction\n            if (initial.rect.x > last.rect.x) {\n                // left to right\n                horizontalDirection = RIGHT_TO_LEFT;\n            }\n\n            if (initial.rect.y > last.rect.y) {\n                // top to bottom\n                verticalDirection = BOTTOM_TO_TOP\n            }\n\n\t\t\tfor (let cellId in allCells) {\n                let cell = allCells[cellId];\n\n                if (!cell || !cell.rect) {\n                    continue;\n                }\n\n                let selectable = false;\n\n                if (horizontalDirection === LEFT_TO_RIGHT) {\n                    if (verticalDirection === TOP_TO_BOTTOM) {\n                        if (\n                            cell.rect.x <= last.rect.x &&\n                            cell.rect.x >= initial.rect.x &&\n\n                            cell.rect.y >= initial.rect.y &&\n                            cell.rect.y <= last.rect.y\n                        ) {\n                            selectable = true;\n                        }\n                    } else {\n                        if (\n                            cell.rect.x <= last.rect.x &&\n                            cell.rect.x >= initial.rect.x &&\n\n                            cell.rect.y <= initial.rect.y &&\n                            cell.rect.y >= last.rect.y\n                        ) {\n                            selectable = true;\n                        }\n                    }\n                } else { // RIGHT_TO_LEFT\n                    if (verticalDirection === TOP_TO_BOTTOM) {\n                        if (\n                            cell.rect.x >= last.rect.x &&\n                            cell.rect.x <= initial.rect.x &&\n\n                            cell.rect.y >= initial.rect.y &&\n                            cell.rect.y <= last.rect.y\n                        ) {\n                            selectable = true;\n                        }\n                    } else {\n                        if ( // BOTTOM_TO_TOP\n                            cell.rect.x >= last.rect.x &&\n                            cell.rect.x <= initial.rect.x &&\n\n                            cell.rect.y <= initial.rect.y &&\n                            cell.rect.y >= last.rect.y\n                        ) {\n                            selectable = true;\n                        }\n                    }\n                }\n\n                if (selectable) {\n                    dispatch(\n                        SELECT_CELL({\n                            id: cellId\n                        })\n                    );\n                } else {\n                   dispatch(\n                        UNSELECT_CELL({\n                            id: cell.id\n                        })\n                    );\n                }\n\t\t\t}\n\t\t}\n\t}\n\n    const getCells = () => {\n        let cells = [];\n        if (window.table_data) {\n            let cellIndex = 0;\n            window.table_data.forEach(function (cellData, i) {\n                let monthCells = [];\n                for (const month of months) {\n                    let id = getCellId(month, i)\n                    monthCells.push(\n                        <TableCell key={cellIndex} index={cellIndex} cellId={id} />\n                    )\n                    cellIndex++\n                }\n                cells.push(\n                    <TableRow key={i} index={(i + 1)}>\n                        <TableHandle rowIndex={i}>{cellData[\"programme__programme_code\"]} - {cellData[\"programme__programme_description\"]}</TableHandle>\n                        {monthCells}\n                    </TableRow>\n                );\n            });\n        }\n\t    return cells;\n    }\n\n    return (\n        <Fragment>\n            {errorMessage &&\n                <div className=\"govuk-error-summary\" aria-labelledby=\"error-summary-title\" role=\"alert\" tabIndex=\"-1\" data-module=\"govuk-error-summary\">\n                    <h2 className=\"govuk-error-summary__title\" id=\"error-summary-title\">\n                        There is a problem\n                    </h2>\n                    <div className=\"govuk-error-summary__body\">\n                        <ul className=\"govuk-list govuk-error-summary__list\">\n                            <li>\n                                <a href=\"#passport-issued-error\">{errorMessage}</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            }\n            <table className=\"govuk-table\" id=\"forecast-table\">\n                <caption className=\"govuk-table__caption\">Edit forecast</caption>\n                <thead className=\"govuk-table__head\">\n                    <TableRow index=\"0\">\n                        <th className=\"govuk-table__header \">Programme</th>\n                        <ColumnHeader colKey=\"apr\">Apr</ColumnHeader>\n                        <ColumnHeader colKey=\"may\">May</ColumnHeader>\n                        <ColumnHeader colKey=\"jun\">Jun</ColumnHeader>\n                        <ColumnHeader colKey=\"jul\">Jul</ColumnHeader>\n                        <ColumnHeader colKey=\"aug\">Aug</ColumnHeader>\n                        <ColumnHeader colKey=\"sep\">Sep</ColumnHeader>\n                        <ColumnHeader colKey=\"oct\">Oct</ColumnHeader>\n                        <ColumnHeader colKey=\"nov\">Nov</ColumnHeader>\n                        <ColumnHeader colKey=\"dec\">Dec</ColumnHeader>\n                        <ColumnHeader colKey=\"jan\">Jan</ColumnHeader>\n                        <ColumnHeader colKey=\"feb\">Feb</ColumnHeader>\n                        <ColumnHeader colKey=\"mar\">Mar</ColumnHeader>\n                    </TableRow>\n                </thead>\n                <tbody className=\"govuk-table__body\">\n                    {getCells()}\n                </tbody>\n            </table>\n        </Fragment>\n    );\n}\n\nexport default Table;\n","import React, {Fragment, useState, useEffect, useRef } from 'react';\nimport { shallowEqual, useSelector, useDispatch } from 'react-redux';\nimport './App.css';\nimport { Provider } from 'react-redux';\nimport { store } from './Store';\nimport { PersistGate } from 'redux-persist/integration/react';\nimport Table from './Components/Table/index'\n\nfunction App() {\n    return (\n        <Provider store={store}>\n            <Table />\n        </Provider>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport \"./index.scss\";\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}