(window.webpackJsonpfido=window.webpackJsonpfido||[]).push([[0],{17:function(e,t,r){e.exports=r(33)},22:function(e,t,r){},28:function(e,t,r){},33:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),l=r(5),o=r.n(l),c=(r(22),r(2)),i=(r(28),r(1)),d=r(16),u=r(14),s=r.n(u),v="SET_MOUSE_DOWN",f={down:!1},m=r(7),y=Object(m.a)({slice:"allCells",initialState:{},reducers:{ADD_CELL:function(e,t){e[t.payload.id]={index:t.payload.index,programmeCode:t.payload.programmeCode,naturalAccountCode:t.payload.naturalAccountCode,projectCode:t.payload.projectCode,id:t.payload.id,key:t.payload.key,editable:t.payload.editable,value:t.payload.value,rowIndex:t.payload.rowIndex,rect:null,selected:!1,edited:!1}},SET_RECT:function(e,t){e[t.payload.id].rect=t.payload.rect},SELECT_CELL:function(e,t){e[t.payload.id].selected=!0},UNSELECT_CELL:function(e,t){e[t.payload.id].selected=!1},SET_EDITED:function(e,t){e[t.payload.id].edited=!0},SET_VALUE:function(e,t){e[t.payload.id].value=t.payload.value},UNSELECT_ALL:function(e,t){for(var r in e)e[r].selected=!1}}}),E=y.actions,p=E.ADD_CELL,_=E.SELECT_CELL,w=E.UNSELECT_CELL,b=(E.SET_EDITED,E.UNSELECT_ALL),g=E.SET_RECT,x=E.SET_VALUE,C=y.reducer,O="SET_EDIT_CELL",T={cellId:null},h=Object(m.a)({slice:"select",initialState:{initial:null,last:null},reducers:{SET_INITIAL_CELL:function(e,t){e.initial=t.payload.id},SET_LAST_CELL:function(e,t){e.last=t.payload.id}}}),L=h.actions,k=L.SET_INITIAL_CELL,I=L.SET_LAST_CELL,j=h.reducer,S={key:"root",storage:s.a},N=Object(i.combineReducers)({mouse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object.assign({},e,{down:t.down});default:return e}},allCells:C,editCell:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object.assign({},e,{cellId:t.cellId});default:return e}},select:j}),D=(Object(d.a)(S,N),Object(i.createStore)(N)),A=(r(32),r(11)),K=a.a.createContext({}),R=K.Provider,M=(K.Consumer,K);var B=function(e){var t=e.children,r=(e.index,Object(c.b)()),n=Object(c.c)(function(e){return e.allCells});return a.a.createElement(R,{value:{selectRow:function(e){r(b());var t=!1;for(var a in n){var l=n[a];l.editable&&l.rowIndex==e&&(t||(r(k({id:a})),t=!0),r(_({id:a})),r(I({id:a})))}},selectColumn:function(e){r(b());var t=!1;for(var a in n){var l=n[a];l.key==e&&(t||(r(k({id:a})),t=!0),r(_({id:l.id})),r(I({id:a})))}}}},a.a.createElement("tr",{className:"govuk-table__row"},t))},F=function(e,t){return"id_"+e+"_"+t},P=["apr","may","jun","jul","aug","sep","oct","nov","dec","jan","feb","mar"];var U=function(e){e.children,e.index;var t=e.cellId,r=Object(c.b)(),l=a.a.createRef(),o=Object(n.useRef)(null),i=Object(c.c)(function(e){return e.mouse.down}),d=Object(c.c)(function(e){return e.allCells}),u=Object(c.c)(function(e){return e.editCell.cellId});return Object(n.useEffect)(function(){d&&r(g({id:t,rect:l.current.getBoundingClientRect()}))},[]),Object(n.useEffect)(function(){o&&o.current&&o.current.focus()}),a.a.createElement(n.Fragment,null,a.a.createElement("td",{className:function(){var e=d[t];return!(!e||!e.selected)}()?"highlight govuk-table__cell":"no-select govuk-table__cell",ref:l,onDoubleClick:function(){r({type:O,cellId:t})},onMouseOver:function(){i&&(r(_({id:t})),r(I({id:t})))},onMouseDown:function(){r(_({id:t})),r(k({id:t})),r(I({id:t}))}},u==t?a.a.createElement("input",{className:"cell-input",ref:o,type:"text",value:d[t].value,onChange:function(e){return n=e.target.value,void(parseInt(n)&&r(x({id:t,value:n})));var n},onKeyPress:function(e){"Enter"===e.key&&r({type:O,cellId:null})},onKeyDown:function(e){if(9==e.keyCode){var n=d[t],a=P.indexOf(n.key),l=[];for(var o in d){var c=d[o];l.push(c)}var i=l.filter(function(e){return e.rowIndex==n.rowIndex&&e.key===P[a+1]})[0];r({type:b}),r(I({id:i.id})),r(k({id:i.id})),r(_({id:i.id})),r({type:O,cellId:i.id})}}}):a.a.createElement(n.Fragment,null,d[t].value)))};var J=function(e){var t=e.children,r=e.rowIndex,l=Object(n.useContext)(M);return a.a.createElement("td",{className:"handle govuk-table__cell indicate-action",onClick:function(){l.selectRow(r)}},t)};var G=function(e){var t=e.children,r=e.colKey,l=Object(n.useContext)(M);return a.a.createElement("th",{className:"govuk-table__header indicate-action",onClick:function(){l.selectColumn(r)}},t)};var H=function(){var e=Object(c.b)(),t=Object(c.c)(function(e){return e.select.initial}),r=Object(c.c)(function(e){return e.select.last}),l=Object(n.useState)([]),o=Object(A.a)(l,2),i=(o[0],o[1],Object(n.useState)(null)),d=Object(A.a)(i,2),u=d[0],s=d[1],f=Object(c.c)(function(e){return e.mouse.down}),m=Object(c.c)(function(e){return e.allCells}),y=function(t){e({type:b}),"input"!=t.srcElement.localName&&e({type:O,cellId:null}),e({type:v,down:!0})},E=function(t){e({type:v,down:!1})},g=function(t){if(console.log(t),9==t.keyCode&&"input"!=t.target.localName){var r=D.getState(),n=r.allCells[r.select.initial],a=P.indexOf(n.key),l=[];for(var o in r.allCells){var c=r.allCells[o];l.push(c)}console.log(l);var i=l.filter(function(e){return e.rowIndex==n.rowIndex&&e.key===P[a+1]})[0];e({type:b}),e(I({id:i.id})),e(k({id:i.id})),e(_({id:i.id})),e({type:O,cellId:i.id})}},C=function(e,t){var r=t,n=!0,a=!1,l=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var i=o.value;i.rect.x<r.rect.x&&i.rect.y<r.rect.y&&(r=i)}}catch(d){a=!0,l=d}finally{try{n||null==c.return||c.return()}finally{if(a)throw l}}return r},T=function(t){var r=t.clipboardData.getData("Text").split("\n"),n=D.getState(),a=n.select.initial,l=n.allCells[a],o=[];for(var c in n.allCells){var i=n.allCells[c];o.push(i)}if(l.selected){var d=o.filter(function(e){return e.selected}),u=C(d,l),v=u.rowIndex,f=!0,m=!1,y=void 0;try{for(var E,p=function(){var t=E.value.split("\t"),r=P.indexOf(u.key),n=!0,a=!1,l=void 0;try{for(var c,i=t[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var d=c.value;if(parseInt(d)){var f=o.filter(function(e){return e.rowIndex==v&&e.key===P[r]});f[0]&&(e(x({id:f[0].id,value:d})),e(_({id:f[0].id})),e(I({id:f[0].id}))),r++}else s("You can only paste whole numbers into cells")}}catch(m){a=!0,l=m}finally{try{n||null==i.return||i.return()}finally{if(a)throw l}}v++},w=r[Symbol.iterator]();!(f=(E=w.next()).done);f=!0)p()}catch(b){m=!0,y=b}finally{try{f||null==w.return||w.return()}finally{if(m)throw y}}}},h=function(e){var t=D.getState(),r=[];for(var n in t.allCells){var a=t.allCells[n];r.push(a)}var l=t.select.initial,o=t.allCells[l];if(o.selected){e.preventDefault();var c=r.filter(function(e){return e.selected}),i=C(c,o);console.log(c);var d="",u=i.rowIndex,s=!0,v=!1,f=void 0;try{for(var m,y=c[Symbol.iterator]();!(s=(m=y.next()).done);s=!0){var E=m.value;E.rowIndex!=u&&(u=E.rowIndex,d+="\n"),d+=E.value+"\t",console.log(E.value+"\t"),console.log(d)}}catch(p){v=!0,f=p}finally{try{s||null==y.return||y.return()}finally{if(v)throw f}}console.log("clipBoardContent.trim()",d),navigator.clipboard.writeText(d)}};if(Object(n.useEffect)(function(){window.cell_data=m},[m]),Object(n.useEffect)(function(){var t=0;return window.table_data.forEach(function(r,n){for(var a in r){for(var l=!1,o=0;o<window.editable_periods.length;o++){var c=window.editable_periods[o].fields.period_short_name;if(c&&c.toLowerCase()==a){l=!0;break}}e(p({id:F(a,n),index:t,rowIndex:n,key:a,value:r[a],editable:l,programmeCode:r.programme__programme_code,naturalAccountCode:r.natural_account_code__natural_account_code})),t++}}),window.addEventListener("mousedown",y),window.addEventListener("mouseup",E),window.addEventListener("paste",T),window.addEventListener("keydown",g),window.addEventListener("copy",h),function(){window.removeEventListener("onmouseup",y),window.removeEventListener("mousedown",E),window.removeEventListener("paste",T),window.removeEventListener("keydown",g),window.removeEventListener("copy",h)}},[]),f){var L=m[t],j=m[r];if(L&&j){var S="LEFT_TO_RIGHT",N="TOP_TO_BOTTOM";for(var K in L.rect.x>j.rect.x&&(S="RIGHT_TO_LEFT"),L.rect.y>j.rect.y&&(N="BOTTOM_TO_TOP"),m){var R=m[K];if(R&&R.rect){var M=!1;"LEFT_TO_RIGHT"===S?"TOP_TO_BOTTOM"===N?R.rect.x<=j.rect.x&&R.rect.x>=L.rect.x&&R.rect.y>=L.rect.y&&R.rect.y<=j.rect.y&&(M=!0):R.rect.x<=j.rect.x&&R.rect.x>=L.rect.x&&R.rect.y<=L.rect.y&&R.rect.y>=j.rect.y&&(M=!0):"TOP_TO_BOTTOM"===N?R.rect.x>=j.rect.x&&R.rect.x<=L.rect.x&&R.rect.y>=L.rect.y&&R.rect.y<=j.rect.y&&(M=!0):R.rect.x>=j.rect.x&&R.rect.x<=L.rect.x&&R.rect.y<=L.rect.y&&R.rect.y>=j.rect.y&&(M=!0),e(M?_({id:K}):w({id:R.id}))}}}}return a.a.createElement(n.Fragment,null,u&&a.a.createElement("div",{className:"govuk-error-summary","aria-labelledby":"error-summary-title",role:"alert",tabIndex:"-1","data-module":"govuk-error-summary"},a.a.createElement("h2",{className:"govuk-error-summary__title",id:"error-summary-title"},"There is a problem"),a.a.createElement("div",{className:"govuk-error-summary__body"},a.a.createElement("ul",{className:"govuk-list govuk-error-summary__list"},a.a.createElement("li",null,a.a.createElement("a",{href:"#passport-issued-error"},u))))),a.a.createElement("table",{className:"govuk-table",id:"forecast-table"},a.a.createElement("caption",{className:"govuk-table__caption"},"Edit forecast"),a.a.createElement("thead",{className:"govuk-table__head"},a.a.createElement(B,{index:"0"},a.a.createElement("th",{className:"govuk-table__header "},"Programme"),a.a.createElement(G,{colKey:"apr"},"Apr"),a.a.createElement(G,{colKey:"may"},"May"),a.a.createElement(G,{colKey:"jun"},"Jun"),a.a.createElement(G,{colKey:"jul"},"Jul"),a.a.createElement(G,{colKey:"aug"},"Aug"),a.a.createElement(G,{colKey:"sep"},"Sep"),a.a.createElement(G,{colKey:"oct"},"Oct"),a.a.createElement(G,{colKey:"nov"},"Nov"),a.a.createElement(G,{colKey:"dec"},"Dec"),a.a.createElement(G,{colKey:"jan"},"Jan"),a.a.createElement(G,{colKey:"feb"},"Feb"),a.a.createElement(G,{colKey:"mar"},"Mar"))),a.a.createElement("tbody",{className:"govuk-table__body"},function(){var e=[];if(window.table_data){var t=0;window.table_data.forEach(function(r,n){var l=[],o=!0,c=!1,i=void 0;try{for(var d,u=P[Symbol.iterator]();!(o=(d=u.next()).done);o=!0){var s=d.value,v=F(s,n);l.push(a.a.createElement(U,{key:t,index:t,cellId:v})),t++}}catch(f){c=!0,i=f}finally{try{o||null==u.return||u.return()}finally{if(c)throw i}}e.push(a.a.createElement(B,{key:n,index:n+1},a.a.createElement(J,{rowIndex:n},r.programme__programme_code," - ",r.programme__programme_description),l))})}return e}())))};var W=function(){return a.a.createElement(c.a,{store:D},a.a.createElement(H,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,1,2]]]);
//# sourceMappingURL=main.55e6c9ea.chunk.js.map